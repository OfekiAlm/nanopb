syntax = "proto3";
import "generator/proto/nanopb.proto";

package test;

// Example messages that can be payloads
message LoginRequest {
    string username = 1 [(nanopb).max_length = 32];
    string password = 2 [(nanopb).max_length = 64];
}

message LogoutRequest {
    string session_id = 1 [(nanopb).max_length = 64];
}

message ChatMessage {
    string content = 1 [(nanopb).max_length = 256];
    uint32 timestamp = 2;
}

// Opcode enum
enum MessageType {
    MSG_LOGIN = 0;
    MSG_LOGOUT = 1;
    MSG_CHAT = 2;
}

// Envelope message using oneof pattern
message Envelope {
    MessageType type = 1;
    oneof payload {
        LoginRequest login = 2;
        LogoutRequest logout = 3;
        ChatMessage chat = 4;
    }
    uint64 timestamp = 5;
}
