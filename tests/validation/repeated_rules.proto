/* Test repeated field validation rules */

syntax = "proto3";

import "validate.proto";
import "nanopb.proto";

option (validate.validate) = true;

/* Test repeated field rules */
message RepeatedRules {
    /* min_items constraint */
    repeated int32 min_items_field = 1 [
        (nanopb).max_count = 10,
        (validate.rules).repeated.min_items = 1
    ];
    
    /* max_items constraint */
    repeated int32 max_items_field = 2 [
        (nanopb).max_count = 10,
        (validate.rules).repeated.max_items = 5
    ];
    
    /* Range constraint */
    repeated int32 range_items_field = 3 [
        (nanopb).max_count = 10,
        (validate.rules).repeated.min_items = 2,
        (validate.rules).repeated.max_items = 8
    ];
    
    /* unique constraint (note: implementation pending) */
    repeated int32 unique_field = 4 [
        (nanopb).max_count = 10,
        (validate.rules).repeated.unique = true
    ];
}

/* Test repeated with string items */
message RepeatedStringRules {
    repeated string names = 1 [
        (nanopb).max_count = 5,
        (nanopb).max_size = 32,
        (validate.rules).repeated.min_items = 1,
        (validate.rules).repeated.max_items = 5
    ];
}

/* Test message with repeated string with min_len/max_len items validation */
message RepeatedStringItems {
    repeated string values = 1 [
        (nanopb).max_count = 10,
        (nanopb).max_size = 64,
        (validate.rules).repeated = {
            items: {
                string: {
                    min_len: 3
                    max_len: 10
                }
            }
        }
    ];
}

/* Test message with repeated int32 with gt/lt items validation */
message RepeatedInt32Items {
    repeated int32 values = 1 [
        (nanopb).max_count = 10,
        (validate.rules).repeated = {
            items: {
                int32: {
                    gt: 0
                    lt: 100
                }
            }
        }
    ];
}

/* Test message with repeated string with unique constraint */
message RepeatedUniqueStrings {
    repeated string values = 1 [
        (nanopb).max_count = 10,
        (nanopb).max_size = 64,
        (validate.rules).repeated.unique = true
    ];
}

/* Test message with repeated int32 with unique constraint */
message RepeatedUniqueInt32 {
    repeated int32 values = 1 [
        (nanopb).max_count = 10,
        (validate.rules).repeated.unique = true
    ];
}

/* Test message with both items and unique constraints */
message RepeatedBothConstraints {
    repeated string values = 1 [
        (nanopb).max_count = 10,
        (nanopb).max_size = 64,
        (validate.rules).repeated = {
            items: {
                string: {
                    min_len: 2
                }
            }
            unique: true
        }
    ];
}

/* Test message with combined min_items, max_items, items, and unique */
message RepeatedAllConstraints {
    repeated int32 numbers = 1 [
        (nanopb).max_count = 20,
        (validate.rules).repeated = {
            min_items: 1
            max_items: 10
            items: {
                int32: {
                    gte: 0
                    lte: 1000
                }
            }
            unique: true
        }
    ];
}