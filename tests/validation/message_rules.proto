/* Test nested message validation rules */

syntax = "proto3";

import "validate.proto";
import "nanopb.proto";

option (validate.validate) = true;

/* Address submessage */
message Address {
    string city = 1 [(nanopb).max_size = 64, (validate.rules).string.min_len = 1];
    string zip_code = 2 [(nanopb).max_size = 16, (validate.rules).string.min_len = 3, (validate.rules).string.max_len = 10];
    string ip_address = 3 [(nanopb).max_size = 46, (validate.rules).string.ip = true];
}

/* Contact submessage */
message Contact {
    string email = 1 [(nanopb).max_size = 128, (validate.rules).string.email = true];
    string phone = 2 [(nanopb).max_size = 20, (validate.rules).string.min_len = 5];
}

/* Test nested message validation with optional field */
message MessageRules {
    /* Required string field */
    string name = 1 [(nanopb).max_size = 64, (validate.rules).string.min_len = 1];
    
    /* Nested message - optional */
    Address address = 2;
    
    /* Another nested message */
    Contact contact = 3;
    
    /* Numeric field with constraints */
    int32 age = 4 [(validate.rules).int32.gte = 0, (validate.rules).int32.lte = 150];
}

/* Test deeply nested messages */
message DeepNested {
    message Inner {
        string value = 1 [(nanopb).max_size = 32, (validate.rules).string.min_len = 1];
        int32 count = 2 [(validate.rules).int32.gte = 0];
    }
    
    Inner inner = 1;
    string outer_name = 2 [(nanopb).max_size = 64];
}
